# NeuroDetekt

Система обнаружения вторжений на основе нейронных сетей, использующая методы глубокого обучения для выявления аномалий в последовательностях системных вызовов.

## О проекте

NeuroDetekt представляет собой систему обнаружения вторжений на хосте (HIDS), которая автоматически выявляет события, указывающие на компрометацию системы злоумышленниками. В основе подхода лежит обнаружение аномалий в последовательностях системных вызовов путем обучения базовой языковой модели и выявления отклонений от нее.

### Основные возможности:
- Обучение LSTM-моделей на последовательностях системных вызовов
- Детектирование аномальных последовательностей в тестовых данных
- Балансировка данных и оптимизация порогов обнаружения
- Ансамблевое моделирование для повышения точности обнаружения
- Поддержка кросс-валидации

## Настройка окружения

Рекомендуется использовать Anaconda Python Distribution. Conda-окружение указано в файле `environment.yml`.

```bash
conda env create -f environment.yml
conda activate neurodetekt
```

Или используйте скрипт автоматического обновления (для Linux/macOS):

```bash
chmod +x update_environment.sh
./update_environment.sh
```

### Проверка окружения

Перед запуском обучения рекомендуется проверить настройку окружения:

```bash
python src/check_environment.py
```

Этот скрипт проверит:
- Установленные библиотеки и их версии
- Совместимость NumPy и PyTorch
- Доступность CUDA для ускорения обучения
- Наличие необходимых файлов и данных

### Устранение типичных проблем

1. **Проблема с версией NumPy**:
   Если вы видите ошибку о несовместимости NumPy 2.x и PyTorch, установите совместимую версию:
   ```bash
   conda install numpy=1.24.3
   ```

2. **Ошибки CUDA**:
   Если возникают проблемы с CUDA, можно запустить обучение на CPU:
   ```bash
   python src/train_balanced_ensemble.py --device cpu
   ```

## Наборы данных

Проект использует набор данных PLAID (Plaid Lab Artificial Intrusion Dataset), включенный в репозиторий. Для использования просто распакуйте `data/PLAID.tar.xz`.

## Обучение и оценка моделей

### Обучение модели
```bash
python src/train_ensemble.py --batch_size 64 --epochs 15 --cells 128 --dropout 0.2
```

### Обучение ансамбля моделей с балансировкой данных
```bash
python src/train_balanced_ensemble.py --batch_size 96 --epochs 15 --ensemble_size 3 --balance_factor 1.5
```

### Оптимизация порога обнаружения
```bash
python src/optimize_threshold.py --model_path trials/lstm_model_00.pt --balance_factor 1.5
```

## Структура проекта

- `src/` - исходный код проекта
- `data/` - наборы данных
- `trials/` - результаты экспериментов
- `out/` - выходные данные и сохраненные разделения наборов данных

## Технологии

- Python 3.9
- PyTorch 2.1.0
- scikit-learn
- CUDA (опционально для GPU-ускорения)

